!function(){"use strict";var a={backendAdapter:"sinonjs",verbose:!1},b=function(){var b={},c={};return{version:"0.3.0",config:function(b){a=_.extend(a,b||{})},backend:function(){return smocker[a.backendAdapter].backend()},scenario:function(a,c){b[a]=c},groupScenarios:function(a,b){c[a]=b},play:function(){var a=new smocker.HttpProxy;_.each(_.toArray(arguments),function(d){if(_.isFunction(d))d.call(a);else if(b[d])b[d].call(a);else{if(!c[d])throw"Scenario or Group undefined: "+d;_.each(c[d],function(c){b[c].call(a)})}})}}};window.smocker=b(),"object"==typeof module&&"function"==typeof require&&(module.exports=window.smocker),smocker.FixtureResponse=function(a,b,c){this.fixturePath=c,this.matches=function(c,d){return a===c?_.isRegExp(b)?b.test(d):b===d:!1}},smocker.HttpProxy=function(){var a=smocker.backend();_.each(["get","post","put","delete"],function(b){var c=b.toUpperCase();this[b]=function(b){return{redirectToFixture:function(d){a.redirect(c,b,d)},respondWith:function(d){a.process(c,b,new smocker.RequestHandler(d))},forwardToServer:function(){a.forward(c,b)}}}},this)},smocker.RequestHandler=function(a){this.response=function(b,c,d){var f;return f=_.isString(a)?{headers:{"Content-Type":"text/plain;charset=utf-8"},content:a}:_.isFunction(a)?a(b,c,d):a,f=_.defaults(f,{status:200,headers:{"Content-Type":"application/json;charset=utf-8"},content:{},delay:0}),e(f),f}},function(a){smocker.angularjs=_.extend(a,{createAngularModule:function(){return angular.module("smockerFixture",["ng"]).config(["$provide",function(a){a.decorator("$httpBackend",["$delegate",smocker.angularjs.fixtureHttpBackendDecorator])}]),_.tap(angular.module("smockerE2E",["smockerFixture","ngMockE2E"]),function(a){a.config(["$provide",function(a){a.decorator("$httpBackend",["$delegate",smocker.angularjs.smockerHttpBackendDecorator])}])})}})}(smocker.angularjs||{}),function(a){smocker.angularjs=_.extend(a,{backend:function(){f("angular.module","angular.mock"),this.fixtureResponseMappings=[];var a=this.createAngularModule(),b=function(b){a.run(["$httpBackend",b])};return{redirect:function(a,c,d){b(function(b){b.when(a.toUpperCase(),c).fixture(d)})},process:function(a,c,e){b(function(b){b.when(a.toUpperCase(),c).respond(function(a,c,f,g){d(a+" "+c);var h=e.response(c,f,g);return b.responseDelay=h.delay,[h.status,h.content,h.headers]})})},forward:function(a,c){b(function(b){b.when(a.toUpperCase(),c).passThrough()})}}}})}(smocker.angularjs||{}),function(a){smocker.angularjs=_.extend(a,{delayInterceptor:function(a,b){return function(){var c=arguments;_.isNumber(a.responseDelay)&&a.responseDelay>0?setTimeout(function(){b.apply(null,c)},1e3*a.responseDelay):b.apply(null,c)}}})}(smocker.angularjs||{}),function(a){smocker.angularjs=_.extend(a,{fixtureHttpBackendDecorator:function(a){var b=function(b,c,d,e,f){var g=_.find(smocker.angularjs.fixtureResponseMappings,function(a){return a.matches(b,c)});return g?a.call(this,"GET",g.fixturePath,d,e,f):a.apply(this,arguments)};return b}})}(smocker.angularjs||{}),function(a){smocker.angularjs=_.extend(a,{smockerHttpBackendDecorator:function(a){var b=function(c,d,e,f,g){return a.call(this,c,d,e,smocker.angularjs.delayInterceptor(b,f),g)};return _.each(_.keys(a),function(c){b[c]=a[c]}),b.when=function(b,c){return _.tap(a.when.apply(this,arguments),function(a){a.fixture=function(a){smocker.angularjs.fixtureResponseMappings.push(new smocker.FixtureResponse(b,c,a)),this.passThrough()}})},b}})}(smocker.angularjs||{}),function(a){smocker.canjs=_.extend(a,{backend:function(){return f("can.fixture"),{redirect:function(a,b,c){can.fixture(a+" "+b,c)},process:function(a,b,c){can.fixture(a+" "+b,function(e,f,g){d(a+" "+b);var h=c.response(e.url,e.data,g);h.delay>0?setTimeout(function(){f(h.status,"",h.content,h.headers)},1e3*h.delay):f(h.status,"",h.content,h.headers)})},forward:function(){}}}})}(smocker.canjs||{}),function(a){smocker.sinonjs=_.extend(a,{backend:function(){f("sinon");var a=this.fakeServer();return this.fixtureResponseMappings=[],{redirect:function(a,b,c){smocker.sinonjs.fixtureResponseMappings.push(new smocker.FixtureResponse(a.toUpperCase(),b,c))},process:function(b,c,d){a.respondWith(b.toUpperCase(),c,function(a){var b=d.response(a.url,a.requestHeaders,a.requestBody),c=a.respond.bind(a,b.status,b.headers,JSON.stringify(b.content));_.isNumber(b.delay)&&b.delay>0?(a.readyState=4,setTimeout(c,1e3*b.delay)):c()})},forward:function(a,b){sinon.FakeXMLHttpRequest.addFilter(new smocker.FixtureResponse(a.toUpperCase(),b).matches)}}}})}(smocker.sinonjs||{}),function(a){smocker.sinonjs=_.extend(a,{fakeServer:function(){return sinon.FakeXMLHttpRequest.useFilters=!0,sinon.FakeXMLHttpRequest.prototype.open=_.wrap(sinon.FakeXMLHttpRequest.prototype.open,this.xhrOpenFixtureInterceptor),_.tap(sinon.fakeServer.create(),function(a){a.autoRespond=!0})}})}(smocker.sinonjs||{}),function(a){smocker.sinonjs=_.extend(a,{xhrOpenFixtureInterceptor:function(a,b,c,d,e,f){var g=_.find(smocker.sinonjs.fixtureResponseMappings,function(a){return a.matches(b,c)});return g?sinon.FakeXMLHttpRequest.defake(this,["GET",g.fixturePath,d,e,f]):a.call(this,b,c,d,e,f)}})}(smocker.sinonjs||{});var c=function(){a.verbose&&console.info.apply(null,arguments)},d=function(a){c("[smocker-request]: ",a)},e=function(a){c("[smocker-response]: ",a)},f=function(){_.each(_.toArray(arguments),function(a){_.inject(a.split("."),function(a,b){if(_.isUndefined(a[b]))throw b+" is not defined. Make sure you load the required library before smocker.js";return a[b]},window)})}}();