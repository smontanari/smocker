!function(){"use strict";var a=function(){var a={backendFactory:"canjs",verbose:!1},b=function(){a.verbose&&console.info.apply(null,arguments)},c={},d={};return{version:"0.1.0",config:function(b){a=_.extend(a,b||{})},backend:function(){return smocker[a.backendFactory].backend()},logger:{logRequest:function(a){b("[smocker-request]: ",a)},logResponse:function(a){b("[smocker-response]: ",a)}},defineScenario:function(a,b){c[a]=b},defineSuite:function(a,b){d[a]=b},play:function(){var a=new smocker.HttpServer;_.each(_.toArray(arguments),function(b){if(_.isFunction(b))b.call(a);else if(c[b])c[b].call(a);else{if(!d[b])throw"Scenario or Suite undefined: "+b;_.each(d[b],function(b){c[b].call(a)})}})}}};window.smocker=a(),smocker.HttpServer=function(){var a=smocker.backend();_.each(["get","post","put","delete"],function(b){var c=b.toUpperCase();this[b]=function(b){return{redirectTo:function(d){a.staticResponse(c,b,d)},respondWith:function(d){a.process(c,b,new smocker.RequestHandler(d))}}}},this)},smocker.RequestHandler=function(a){this.respond=function(b,c,d){var e;return e=_.isString(a)?{headers:{"Content-Type":"text/plain"},content:a}:_.isFunction(a)?a(b,c,d):a,_.defaults(e,{status:200,headers:{"Content-Type":"application/json"},content:{},delay:0})}},smocker.canjs={backend:function(){return{staticResponse:function(a,b,c){can.fixture(a+" "+b,c)},process:function(a,b,c){can.fixture(a+" "+b,function(d,e,f){smocker.logger.logRequest(a+" "+b);var g=c.respond(d.url,d.data,f);smocker.logger.logResponse(g),g.delay>0?setTimeout(function(){e(g.status,"",g.content,g.headers)},1e3*g.delay):e(g.status,"",g.content,g.headers)})}}}}}();