!function(){"use strict";var a=function(){var a={backendFactory:{namespace:"canjs",options:{}},verbose:!1},b=function(){a.verbose&&console.info.apply(null,arguments)},c={},d={};return{version:"0.2.1",config:function(b){a=_.extend(a,b||{})},backend:function(){return smocker[a.backendFactory.namespace].backend(a.backendFactory.options)},logger:{logRequest:function(a){b("[smocker-request]: ",a)},logResponse:function(a){b("[smocker-response]: ",a)}},defineScenario:function(a,b){c[a]=b},defineSuite:function(a,b){d[a]=b},play:function(){var a=new smocker.HttpProxy;_.each(_.toArray(arguments),function(b){if(_.isFunction(b))b.call(a);else if(c[b])c[b].call(a);else{if(!d[b])throw"Scenario or Suite undefined: "+b;_.each(d[b],function(b){c[b].call(a)})}})}}};window.smocker=a(),smocker.HttpProxy=function(){var a=smocker.backend();_.each(["get","post","put","delete"],function(b){var c=b.toUpperCase();this[b]=function(b){return{redirectToFixture:function(d){a.redirect(c,b,d)},respondWith:function(d){a.process(c,b,new smocker.RequestHandler(d))},forwardToServer:function(){a.forward(c,b)}}}},this)},smocker.RequestHandler=function(a){this.response=function(b,c,d){var e;return e=_.isString(a)?{headers:{"Content-Type":"text/plain"},content:a}:_.isFunction(a)?a(b,c,d):a,_.defaults(e,{status:200,headers:{"Content-Type":"application/json"},content:{},delay:0})}},function(a){smocker.angularjs=_.extend(a,{createDelayInterceptor:function(a,b){return function(){var c=arguments;_.isNumber(a.responseDelay)&&a.responseDelay>0?setTimeout(function(){b.apply(null,c)},1e3*a.responseDelay):b.apply(null,c)}}})}(smocker.angularjs||{}),function(a){smocker.angularjs=_.extend(a,{createFixtureHttpBackendDecorator:function(a){var b=function(b,c,d,e,f){var g=_.find(smocker.angularjs.fixtureResponseMappings,function(a){return a.matches(b,c)});return g?a.call(this,"GET",g.fixturePath,d,e,f):a.apply(this,arguments)};return b}})}(smocker.angularjs||{}),function(a){smocker.angularjs=_.extend(a,{FixtureResponse:function(a,b,c){this.fixturePath=c,this.matches=function(c,d){return a===c&&b===d}}})}(smocker.angularjs||{}),function(a){smocker.angularjs=_.extend(a,{createSmockerHttpBackendDecorator:function(a){var b=function(c,d,e,f,g){return a.call(this,c,d,e,smocker.angularjs.createDelayInterceptor(b,f),g)};return _.each(_.keys(a),function(c){b[c]=a[c]}),b.when=function(b,c){return _.tap(a.when.apply(this,arguments),function(a){a.fixture=function(a){smocker.angularjs.fixtureResponseMappings.push(new smocker.angularjs.FixtureResponse(b,c,a)),this.passThrough()}})},b}})}(smocker.angularjs||{}),function(a){smocker.angularjs=_.extend(a,{createAngularModule:function(a){return angular.module("smockerE2E",["ng"]).config(["$provide",function(a){a.decorator("$httpBackend",["$delegate",smocker.angularjs.createFixtureHttpBackendDecorator])}]),_.tap(angular.module(a,["smockerE2E","ngMockE2E"]),function(a){a.config(["$provide",function(a){a.decorator("$httpBackend",["$delegate",smocker.angularjs.createSmockerHttpBackendDecorator])}])})}})}(smocker.angularjs||{}),function(a){smocker.angularjs=_.extend(a,{backend:function(){this.fixtureResponseMappings=[];var a=this.createAngularModule("smocker"),b=function(b){a.run(["$httpBackend",b])};return{redirect:function(a,c,d){b(function(b){b.when(a.toUpperCase(),c).fixture(d)})},process:function(a,c,d){b(function(b){b.when(a.toUpperCase(),c).respond(function(a,c,e,f){var g=d.response(c,e,f);return b.responseDelay=g.delay,[g.status,g.content,g.headers]})})},forward:function(a,c){b(function(b){b.when(a.toUpperCase(),c).passThrough()})}}}})}(smocker.angularjs||{}),function(a){smocker.canjs=_.extend(a,{backend:function(){return{redirect:function(a,b,c){can.fixture(a+" "+b,c)},process:function(a,b,c){can.fixture(a+" "+b,function(d,e,f){smocker.logger.logRequest(a+" "+b);var g=c.response(d.url,d.data,f);smocker.logger.logResponse(g),g.delay>0?setTimeout(function(){e(g.status,"",g.content,g.headers)},1e3*g.delay):e(g.status,"",g.content,g.headers)})},forward:function(){}}}})}(smocker.canjs||{})}();